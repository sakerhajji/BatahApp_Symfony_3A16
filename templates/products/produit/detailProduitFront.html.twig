<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details</title>
    <!-- Link Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Link Swiper CSS -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ asset('/image/uploads/logo.png') }}" />
    <style>
        /* Styles pour rendre le contenu plus grand */
        body {
            background-color: #f8f9fa; /* Couleur de fond */
            font-family: Arial, sans-serif; /* Police de caractères */
            color: #333; /* Couleur du texte */
        }

        .container {
            max-width: 1200px; /* Largeur maximale du contenu */
            margin: 0 auto; /* Centrer le contenu horizontalement */
            padding: 20px; /* Ajouter de l'espace intérieur */
        }

        .portfolio-details {
            background-color: #fff; /* Couleur de fond de la section */
            border-radius: 15px; /* Coins arrondis */
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1); /* Ombre douce */
            padding: 40px; /* Ajouter de l'espace intérieur */
            margin-bottom: 40px; /* Ajouter de l'espace en bas */
        }

        .portfolio-details h3 {
            color: #007bff; /* Couleur du titre */
            font-size: 24px; /* Taille du titre */
            font-weight: bold; /* Police en gras */
            margin-top: 0; /* Supprimer la marge supérieure */
        }

        .portfolio-details ul {
            list-style: none; /* Supprimer les puces */
            padding: 0; /* Supprimer le remplissage */
        }

        .portfolio-details ul li {
            margin-bottom: 10px; /* Ajouter de l'espace entre les éléments */
            font-size: 18px; /* Taille du texte */
        }

        .portfolio-details .btn {
            background-color: #007bff; /* Couleur de fond du bouton */
            color: #fff; /* Couleur du texte du bouton */
            border: none; /* Supprimer la bordure */
            border-radius: 5px; /* Coins arrondis */
            padding: 10px 20px; /* Ajouter de l'espace intérieur */
            font-size: 18px; /* Taille du texte */
            text-decoration: none; /* Supprimer le soulignement */
            transition: background-color 0.3s; /* Animation de transition */
        }

        .portfolio-details .btn:hover {
            background-color: #0056b3; /* Changement de couleur au survol */
        }

        /* Styles pour les commentaires */
        .comment-list {
            margin-top: 40px; /* Ajouter de l'espace au-dessus de la liste des commentaires */
        }

        .comment-item {
            margin-bottom: 20px; /* Ajouter de l'espace entre les commentaires */
            padding: 20px; /* Ajouter de l'espace intérieur */
            background-color: #f5f5f5; /* Couleur de fond des commentaires */
            border-radius: 10px; /* Coins arrondis */
        }

        .comment-item .comment-text {
            margin-bottom: 10px; /* Ajouter de l'espace sous le texte du commentaire */
        }

        .comment-item .comment-info {
            font-size: 14px; /* Taille du texte de l'information sur le commentaire */
            color: #666; /* Couleur du texte de l'information sur le commentaire */
        }

        .reply-form {
            margin-top: 20px; /* Ajouter de l'espace au-dessus du formulaire de réponse */
        }

        .reply-form textarea {
            width: 100%; /* Largeur à 100% */
            min-height: 100px; /* Hauteur minimale du champ de texte */
            resize: vertical; /* Autoriser le redimensionnement vertical */
        }

        .reply-form .btn {
            margin-top: 10px; /* Ajouter de l'espace au-dessus du bouton */
        }





        .image-gallery {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.main-image-container {
    margin-bottom: 20px;
}

.main-image {
    max-width: 100%;
}

.thumbnails-container {
    display: flex;
    justify-content: center;
}

.thumbnail-image {
    width: 100px; /* Définis la largeur de toutes les miniatures à 100 pixels */
    height: auto; /* Conserve le ratio hauteur/largeur */
    margin-right: 5px; /* Ajoute un espace entre les miniatures */
}

.thumbnail-image:hover {
    transform: scale(1.1);
}

.thumbnail-image.active {
    transform: scale(1.2);
}

    </style>
</head>
<body>
<section id="portfolio-details" class="portfolio-details">
    <div class="container">
        <div class="row gy-4">
            <div class="col-lg-8">
                <div class="portfolio-details-slider swiper">
                    <div class="swiper-wrapper align-items-center">
                        <div class="swiper-slide">
                        {% set images = imagesByLocation[product.getIdProduit()] %}
                        {% if images is not empty %}
                            <div class="image-gallery">
                                <div class="main-image-container">
                                    <img id="mainImage" src="{{ asset(images[0].getUrl()) }}" class="main-image" alt="{{ product.labelle }}">
                                </div>
                                <div class="thumbnails-container">
                                    {% for key, image in images %}
                                        <img src="{{ asset(image.getUrl()) }}" class="thumbnail-image" alt="{{ product.labelle }}" onclick="switchImage('{{ asset(image.getUrl()) }}')">
                                    {% endfor %}
                                </div>
                            </div>
                        {% else %}
                            <!-- Si aucune image n'est disponible, affichez une image par défaut -->
                            <img src="{{ asset('uploads/defaultimage.jpg') }}" class="card-img-top" alt="Default Image">
                        {% endif %}
                             {% if video is defined %}
                            {% set videoIdParts = video|split('v=') %}
                            {% if videoIdParts|length > 1 %}
                                <div id="product-video" class="embed-responsive embed-responsive-16by9">
                                    <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/{{ videoIdParts[1] }}?autoplay=1&mute=1" allowfullscreen></iframe>
                                </div>
                            {% else %}
                                <p>Aucune vidéo disponible pour ce produit.</p>
                            {% endif %}
                        {% else %}
                            <p>Aucune vidéo disponible pour ce produit.</p>
                        {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="portfolio-info">
                    <h3>Informations sur le produit</h3>
                    <ul class="list-unstyled">
                        <li><strong>Numéro de produit:</strong> {{ id }}</li>
                        <li><strong>Nom:</strong> {{ name }}</li>
                        <li><strong>Description:</strong> {{ description }}</li>
                        <li><strong>Disponibilité:</strong> {{ artdispo }}</li>
                        <li><strong>Prix:</strong> {{ prix }}</li>
                        <li><strong>Période de garantie:</strong> {{ pg }}</li>
                        <li><strong>Nombre de vues:</strong> {{ nombreDeVues }}</li>
                    
                        </ul>
                  <div class="property_sp_map mb-4">
    {% if gps is defined and gps is not null %}
        <!-- Utilisation de l'iframe avec le lien de la localisation du produit -->
        <iframe width="100%" height="300" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="{{ gps }}"></iframe>
    {% else %}
        <!-- Affichez un contenu créatif si les coordonnées GPS ne sont pas disponibles -->
        <p class="text-danger">Aucunes coordonnées GPS disponibles pour ce produit.</p>
        <!-- Vous pouvez ajouter n'importe quel contenu créatif ici -->
    {% endif %}
</div>

</div>
                    <a  href="{{ path('app_addToBasket', {'idp': product.getIdProduit()} ) }} class="btn btn-primary">Ajouter au Panier</a>
               
               
                </div>
            </div>
        </div>
    </div>
    <div class="comment-section mt-4">
    <form method="post" action="{{ path('app_Addcomment_event', {'idp': product.getIdProduit(), 'iduser': user.id}) }}">
        <div class="mb-3">
            <label for="commentaire" class="form-label">Your Comment:</label>
            <input type="text" id="commentaire" name="commentaire" class="form-control" placeholder="Write your comment here..." required>
        </div>
        <button type="submit" class="btn btn-primary">Add Comment</button>
    </form>
    
    <div class="comment-section mt-4" style="background-color: #222; color: #fff; padding: 20px;">
        <h3 style="color: #ffc107;">Comments:</h3>

        <ul class="list-group">
            {% if product.comments is not empty %}
                {% for comment in product.comments %}
                    <li class="list-group-item d-flex justify-content-between align-items-start" style="background-color: #333; color: #fff; margin-bottom: 10px;">
                        <div class="comment">
                            <!-- Render parent comment -->
                            <img src="{{ asset('uploads/' ~ comment.idClient.avatar) }}" alt="User Avatar" class="avatar rounded-circle me-2" style="width: 40px; height: 40px;">
                            <span class="fw-bold" style="color: #ffc107;">{{ comment.idClient.nomutilisateur }}:</span> {{ comment.commentaire }}
                        </div>
                        {% if comment.idClient == user %}
                            <div>
                                <a href="{{ path('app_editcomment', {'id': comment.id}) }}" class="btn btn-primary btn-sm me-2">Edit</a>
                                <a href="{{ path('app_deletecomment', {'ref': comment.id, 'idp': product.idProduit, 'iduser': user.id}) }}" class="btn btn-danger btn-sm">Delete</a>
                            </div>
                        {% endif %}
                        <div class="mt-2">
                            <!-- Render reply form -->
                            <form action="{{ path('app_Addcomment_event', {'idp': product.idProduit, 'iduser': user.id}) }}" method="post">
                                <textarea name="commentaire" class="form-control mb-2" placeholder="Reply to this comment" style="background-color: #444; color: #fff;"></textarea>
                                <input type="hidden" name="parentId" value="{{ comment.id }}">
                                <button type="submit" class="btn btn-success btn-sm">Reply</button>
                            </form>
                        </div>
                        
                        <!-- Render replies -->
                        {% if comment.replies is not empty %}
                            <ul class="list-group mt-3">
                                {% for reply in comment.replies %}
                                    <li class="list-group-item" style="background-color: #444; color: #fff; margin-bottom: 5px;">
                                        <img src="{{ asset('uploads/' ~ reply.idClient.avatar) }}" alt="User Avatar" class="avatar rounded-circle me-2" style="width: 30px; height: 30px;">
                                        <span class="fw-bold" style="color: #ffc107;">{{ reply.idClient.nomutilisateur }}:</span> {{ reply.commentaire }}
                                    </li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </li>
                {% endfor %}
            {% else %}
                <p class="mt-3" style="color: #fff;">No comments yet.</p>
            {% endif %}
        </ul>
    </div>
</div>




</section>
<!-- Bouton "Retour au menu" -->
<a href="{{ path('app_afficahge_produits') }}" class="btn btn-primary">Retour au menu</a>
</div>
</section>

<!-- Link Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- Link Swiper JS -->
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<script>
    function switchImage(newImageUrl) {
        document.getElementById('mainImage').src = newImageUrl;
    }
</script>
</body>
</html>



